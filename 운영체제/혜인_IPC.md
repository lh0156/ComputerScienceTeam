# IPC

## IPC

### IPC의 정의

- 프로세스 간 통신(Inter-Process Communication, IPC)이란 프로세스들 사이에 서로 데이터를 주고받는 행위 또는 그에 대한 방법이나 경로를 뜻한다.

### IPC의 목적

- 프로세스들은 모두 각각 OS로부터 할당받은 독립된 공간, 유저공간(user-mode)에서  실행됨
- 독립되어 있는 만큼 별도의 설비가 없이는 서로간에 통신이 어려움
- 하나의 프로그램을 실행하더라도 여러 프로세스끼리 협력이 필요한 상황 존재
- 이를 해결하기 위해 커널 영역(kernel-mode)에서 IPC(Inter-Process Communication)라는 프로세스들 간에 통신을 제공
![image](https://user-images.githubusercontent.com/90780701/168479010-b247b45b-c7f4-4f86-bea3-cf4682222298.png)

## IPC 모델

### 공유 메모리(****Shared memory)****

![image](https://user-images.githubusercontent.com/90780701/168479031-7fbcde6d-ad20-4a27-9cec-3e622cdfc8af.png)

**공유 메모리 모델 특징**

- 두 개 이상의 프로세스들이 주소 공간의 일부를 공유하며, 공유한 메모리 영역에 **Read/Write**를 통해서 통신을 수행
- 프로세스가 공유 메모리 할당을 커널에 요청하면 커널은 해당 프로세스에 메모리 공간을 할당해 주고, 이후 어떤 프로세스건 해당 메모리영역에 접근 가능.
- 공유 메모리가 설정되면, 그 이후의 통신은 커널의 관여 없이 진행 가능.

**공유 메모리 모델의 장점**

- 커널의 관여 없이 메모리를 직접 사용하여 **IPC 속도가 빠름**
- 프로그램 레벨에서 통신 기능을 제공하여, 자유로운 통신이 가능

**공유 메모리 모델의 단점**

- 메시지 전달 방식이 아니기에 데이터를 읽어야하는 시점을 알 수 없음
- 예를 들어, 프로세스 A가 공유 메모리에 데이터 전달해도 프로세스 B가 그것을 알 수 없습니다.
- 그렇기 때문에 별도의 **동기화 기술이 필요**
- 동시에 같은 메모리 위치를 접근하는 문제가 발생할 수 있음 (공유메모리에 접근할 프로세스들 간의 락 메커니즘이 필요)

### ****메세지 전달(Message passing)****

![image](https://user-images.githubusercontent.com/90780701/168479037-00a0e056-3b6c-4d16-8122-54d56a3f422e.png)

**메세지 전달 모델 특징**

- 커널 메모리 영역에 메시지 전달을 위한 채널을 만들어서 협력하는 프로세스들 사이에 메시지 형태로 정보를 **Send/Receive** 하는 방법
- 커널을 경유하여 메시지를 송/수신자끼리 주고 받으며, 커널에서는 데이터를 버퍼링함
- 프로세스간 메모리 공유 없이 동작이 가능

**메세지 전달 모델 장점**

- 커널에서 데이터의 주고받음을 컨트롤할 수 있어 별도의 **동기화 로직이 없어도 됨**

**메세지 전달 모델 단점**

- 커널을 통해서 데이터 주고받기 때문에 **shared memory 모델보다 느림**

****메세지 전달 모델의 종류****

- **Direct Communication**
    
    ![image](https://user-images.githubusercontent.com/90780701/168479060-b6a52a13-b664-4ea1-9a23-ce56c8b0285b.png)

    - 통신하려는 프로세스의 이름을 명시적으로 표시하여 메시지를 직접 전달하는 방식
    - 예를 들어 A 프로세스가 B 프로세스에게 메시지를 전달하고 싶을 때, 수신자 A 프로세스가  커널에게 직접적으로 메시지를 전달한 후, 커널이 B 프로세스에게 해당 메시지를 전달하는 방식
    - 프로세스 간 링크는 유일
    - 대부분 양방향으로 구성
- **Indirect Communication**
    
    ![image](https://user-images.githubusercontent.com/90780701/168479091-400c8084-5d01-4bfd-bc5b-205904545434.png)
    
    - mailbox(또는 port)를 통해 메시지 간접 전달하는 방식
    - port로 전송만 하면 되기 때문에 복잡한 communication link를 만들 수 있으며, 다 : 다 관계가 가능
    - 예를 들어 A 프로세스가 B 프로세스에게 메시지를 전달 하고 싶을 때, 커널 내부 특정 포트에 메시지를 저장해놓고, B 프로세스가 해당 포트에 접근하여 메시지를 전달받는 방식입니다.

**메세지 전달 모델의 예시**

- 파이프
- 메시지 큐
- 소켓
