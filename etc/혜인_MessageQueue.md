## 메시지 큐(Message Queue, MQ)

### 개념

- 프로세스 또는 [프로그램 인스턴스](https://jhnyang.tistory.com/6)가 데이터를 서로 교환할 때 사용하는 통신 방법
- 메시지 지향 미들웨어(Message Oriented Middleware, MOM)를 구현한 시스템을 의미
    - MOM: 비동기 메시지를 사용하는 응용 프로그램 간의 데이터 송수신을 의미
- Producer(sender) 가 메시지를 큐에 전송하면 Consumer(receiver) 가 처리하는 방식
- MQ를 사용하면 비동기로 요청을 처리하고 queue에 저장하여 consumer에게 **병목을 줄여줄 수 있음**

### 사용 이유

- 서버간 데이터를 주고받을 때 항상 시스템 장애를 염두해둬야 함
    - 서버가 죽거나 서버 점검으로 다운타임(시스템을 이용할 수 없는 시간)이 발생하는 동안에는 요청을 보낼 수 없다.
    - 요청하는 서버에서 Failover(장애 극복 기능, 예비 시스템으로 자동전환되는 기능) 처리를 해놓고 연계 시스템이 다시 살아났을 때 요청을 보내는 방법이 있음
- MQ를 이용하면 시스템 장애가 발생했을 때 간편하게 처리할 수 있음
    - Message가 Queue에 쌓였다면 Consumer에서 메시지를 소비하기 전까지 Message Queue에 보관됨
    - 만약 Consumer쪽 Server가 Fail 되었다면 MQ에 보관되는 것

### MQ의 장점

- 비동기: 큐에 넣기 때문에 나중에 처리 가능
- 비동조: 애플리케이션과 분리 가능
- 탄력성: 일부가 실패 시 전체에 영향을 받지 않음
- 과잉: 실패할 경우 재실행이 가능
- 보증: 작업이 처리된 것을 확인 가능
- 확장성: 다수의 프로세스들이 큐에 메시지를 보낼 수 있음

### AMQP(Advanced Message Queing Protocol, MQ 표준 프로토콜)

- 클라이언트 미들웨어 브로커 간 데이터 교환을 위한 MQ기반 메시지 교환 프로토콜

### 오픈 소스 메시지 큐

- RabbitMQ
- ActiveMQ
- ZeroMQ
- Kafka
